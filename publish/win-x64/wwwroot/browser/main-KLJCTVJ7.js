import{a as l}from"./chunk-ATKONDL4.js";import{$ as A,Aa as b,Ba as V,Da as j,Ea as U,F as p,Fa as D,Ga as F,Ha as G,I as v,Ia as B,J as h,N as f,X as d,Y as i,Z as r,_ as a,aa as g,ba as I,da as E,ea as m,f as w,fa as N,g as O,ga as R,i as y,pa as H,qa as z,s as u,t as S,u as T,v as s,w as x,xa as C,ya as L,z as P}from"./chunk-6GEMUR5H.js";var Z=(e,o)=>{let n=u(l).getToken();if(console.log("[AUTH INTERCEPTOR] URL:",e.url),console.log("[AUTH INTERCEPTOR] Token presente:",!!n),n&&!e.url.includes("/auth/login")){let c=e.clone({headers:e.headers.set("Authorization",`Bearer ${n}`)});return console.log("[AUTH INTERCEPTOR] Token agregado al header"),o(c)}return console.log("[AUTH INTERCEPTOR] Request sin token"),o(e)};var k=(e,o)=>{let t=u(l),n=u(F);return t.getToken()?t.verifyToken().pipe(O(()=>!0),y(()=>(n.navigate(["/login"]),w(!1)))):(n.navigate(["/login"]),!1)};var Y=[{path:"",redirectTo:"/login",pathMatch:"full"},{path:"login",loadComponent:()=>import("./chunk-ESGWZ3RD.js").then(e=>e.LoginComponent)},{path:"dashboard",loadComponent:()=>import("./chunk-476OMZBD.js").then(e=>e.DashboardComponent),canActivate:[k]},{path:"history",loadComponent:()=>import("./chunk-QKYNZO26.js").then(e=>e.App),canActivate:[k]},{path:"**",redirectTo:"/login"}];var $={providers:[P(),j(U([Z])),B(Y)]};function X(e,o){e&1&&(s(),i(0,"svg",18),a(1,"path",19),r())}function q(e,o){e&1&&(s(),i(0,"svg",18),a(1,"path",20),r())}function ee(e,o){if(e&1){let t=A();i(0,"div",21)(1,"div",22),m(2),r(),i(3,"div",23)(4,"span",24),m(5),r(),i(6,"button",25),g("click",function(){S(t);let c=I();return T(c.logout())}),m(7,"Cerrar sesi\xF3n"),r()()()}if(e&2){let t=o.ngIf;p(2),R(" ",t.nombre?t.nombre.charAt(0).toUpperCase():t.username.charAt(0).toUpperCase()," "),p(3),N(t.nombre||t.username)}}var _=class e{constructor(o){this.authService=o}mobileMenuOpen=!1;toggleMobileMenu(){this.mobileMenuOpen=!this.mobileMenuOpen}closeMobileMenu(){this.mobileMenuOpen=!1}logout(){this.authService.logout()}static \u0275fac=function(t){return new(t||e)(v(l))};static \u0275cmp=h({type:e,selectors:[["app-navbar"]],decls:24,vars:7,consts:[[1,"navbar"],[1,"nav-container"],[1,"nav-brand"],["width","32","height","32","viewBox","0 0 48 48","fill","none","xmlns","http://www.w3.org/2000/svg"],["width","48","height","48","rx","12","fill","#6366f1"],["d","M24 12C17.373 12 12 17.373 12 24C12 30.627 17.373 36 24 36C30.627 36 36 30.627 36 24C36 17.373 30.627 12 24 12ZM24 33C19.029 33 15 28.971 15 24C15 19.029 19.029 15 24 15C28.971 15 33 19.029 33 24C33 28.971 28.971 33 24 33Z","fill","white"],["d","M24 18C20.686 18 18 20.686 18 24C18 27.314 20.686 30 24 30C27.314 30 30 27.314 30 24C30 20.686 27.314 18 24 18ZM24 27C22.343 27 21 25.657 21 24C21 22.343 22.343 21 24 21C25.657 21 27 22.343 27 24C27 25.657 25.657 27 24 27Z","fill","white"],[1,"brand-name"],["aria-label","Toggle menu",1,"mobile-toggle",3,"click"],["width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor",4,"ngIf"],[1,"nav-menu"],["routerLink","/dashboard",1,"nav-link",3,"click"],["width","20","height","20","viewBox","0 0 20 20","fill","currentColor"],["d","M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"],["routerLink","/history",1,"nav-link",3,"click"],["d","M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"],["fill-rule","evenodd","d","M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z","clip-rule","evenodd"],["class","nav-user",4,"ngIf"],["width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 12h16M4 18h16"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"nav-user"],[1,"user-avatar"],[1,"user-info"],[1,"user-name"],[1,"logout-link",3,"click"]],template:function(t,n){t&1&&(i(0,"nav",0)(1,"div",1)(2,"div",2),s(),i(3,"svg",3),a(4,"rect",4)(5,"path",5)(6,"path",6),r(),x(),i(7,"span",7),m(8,"NutriWeb"),r()(),i(9,"button",8),g("click",function(){return n.toggleMobileMenu()}),f(10,X,2,0,"svg",9)(11,q,2,0,"svg",9),r(),i(12,"div",10)(13,"a",11),g("click",function(){return n.closeMobileMenu()}),s(),i(14,"svg",12),a(15,"path",13),r(),m(16," Dashboard "),r(),x(),i(17,"a",14),g("click",function(){return n.closeMobileMenu()}),s(),i(18,"svg",12),a(19,"path",15)(20,"path",16),r(),m(21," Nueva Historia "),r(),f(22,ee,8,2,"div",17),H(23,"async"),r()()()),t&2&&(p(10),d("ngIf",!n.mobileMenuOpen),p(),d("ngIf",n.mobileMenuOpen),p(),E("active",n.mobileMenuOpen),p(10),d("ngIf",z(23,5,n.authService.currentUser$)))},dependencies:[b,C,G,L],styles:['@charset "UTF-8";.navbar[_ngcontent-%COMP%]{background:#fff;box-shadow:0 1px 3px #0000001a;position:sticky;top:0;z-index:1000}.nav-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:.75rem 1rem;display:flex;align-items:center;justify-content:space-between;gap:2rem}.nav-brand[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;font-weight:700;font-size:1.25rem;color:#1f2937}.brand-name[_ngcontent-%COMP%]{display:none}.mobile-toggle[_ngcontent-%COMP%]{display:none;background:none;border:none;color:#4b5563;cursor:pointer;padding:.5rem}.nav-menu[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem;margin-left:auto}.nav-link[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem 1rem;color:#4b5563;text-decoration:none;border-radius:8px;font-weight:500;transition:all .2s}.nav-link[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#6366f1}.nav-user[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.5rem 1rem;background:#f9fafb;border-radius:999px}.user-avatar[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:.875rem}.user-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.125rem}.user-name[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:#1f2937}.logout-link[_ngcontent-%COMP%]{background:none;border:none;color:#6366f1;font-size:.75rem;cursor:pointer;padding:0;text-align:left;font-weight:500}.logout-link[_ngcontent-%COMP%]:hover{text-decoration:underline}@media(min-width:640px){.brand-name[_ngcontent-%COMP%]{display:inline}}@media(max-width:768px){.mobile-toggle[_ngcontent-%COMP%]{display:block}.nav-menu[_ngcontent-%COMP%]{position:fixed;top:60px;left:0;right:0;background:#fff;flex-direction:column;align-items:stretch;padding:1rem;box-shadow:0 4px 6px #0000001a;transform:translateY(-120%);transition:transform .3s ease}.nav-menu.active[_ngcontent-%COMP%]{transform:translateY(0)}.nav-link[_ngcontent-%COMP%]{padding:1rem;justify-content:flex-start}.nav-user[_ngcontent-%COMP%]{border-radius:12px;padding:1rem}.user-info[_ngcontent-%COMP%]{gap:.25rem}}@media print{.navbar[_ngcontent-%COMP%]{display:none!important}}']})};function te(e,o){e&1&&a(0,"app-navbar")}var M=class e{constructor(o){this.authService=o}static \u0275fac=function(t){return new(t||e)(v(l))};static \u0275cmp=h({type:e,selectors:[["app-root"]],decls:2,vars:1,consts:[[4,"ngIf"]],template:function(t,n){t&1&&(f(0,te,1,0,"app-navbar",0),a(1,"router-outlet")),t&2&&d("ngIf",n.authService.isAuthenticated())},dependencies:[b,C,D,_],styles:["[_nghost-%COMP%]{display:block;min-height:100vh}"]})};V(M,$).catch(e=>console.error(e));
