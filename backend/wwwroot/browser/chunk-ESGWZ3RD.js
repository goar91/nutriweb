import{a as R}from"./chunk-ATKONDL4.js";import{a as z,b as G,c as h,d as I,e as A,g as D,i as V,j,n as q,p as Y}from"./chunk-A2N6GWGJ.js";import{A as u,Aa as T,F as o,Ga as N,I as F,J as k,R as d,S as m,X as f,Y as t,Z as i,_ as s,aa as b,ba as E,da as _,ea as r,ga as y,v as p,w as L}from"./chunk-6GEMUR5H.js";function U(n,a){if(n&1&&(t(0,"div",11),p(),t(1,"svg",20),s(2,"path",36),i(),r(3),i()),n&2){let l=E();o(3),y(" ",l.errorMessage()," ")}}function H(n,a){n&1&&(t(0,"span",15),r(1,"El usuario es requerido"),i())}function W(n,a){n&1&&(p(),t(0,"svg",20),s(1,"path",37)(2,"path",38),i())}function J(n,a){n&1&&(p(),t(0,"svg",20),s(1,"path",39)(2,"path",40),i())}function K(n,a){n&1&&(t(0,"span",15),r(1,"La contrase\xF1a es requerida"),i())}function Q(n,a){n&1&&(s(0,"span",41),r(1," Iniciando sesi\xF3n... "))}function X(n,a){n&1&&r(0," Iniciar Sesi\xF3n ")}function Z(n,a){if(n&1&&(t(0,"div",11),p(),t(1,"svg",20),s(2,"path",36),i(),r(3),i()),n&2){let l=E();o(3),y(" ",l.registerError()," ")}}function $(n,a){n&1&&(t(0,"span",15),r(1,"El usuario es requerido"),i())}function ee(n,a){n&1&&(p(),t(0,"svg",20),s(1,"path",37)(2,"path",38),i())}function te(n,a){n&1&&(p(),t(0,"svg",20),s(1,"path",39)(2,"path",40),i())}function ne(n,a){n&1&&(t(0,"span",15),r(1,"La contrase\xF1a es requerida"),i())}function ie(n,a){n&1&&(t(0,"span",15),r(1,"El email no es v\xE1lido"),i())}function oe(n,a){n&1&&(s(0,"span",41),r(1," Creando cuenta... "))}function re(n,a){n&1&&r(0," Registrarme ")}var B=class n{constructor(a,l,e){this.fb=a;this.authService=l;this.router=e;this.loginForm=this.fb.group({username:["",h.required],password:["",h.required],rememberMe:[!1]}),this.registerForm=this.fb.group({username:["",h.required],password:["",h.required],email:["",h.email]})}loginForm;registerForm;isLoading=u(!1);isRegistering=u(!1);errorMessage=u("");registerError=u("");showPassword=u(!1);showRegisterPassword=u(!1);onSubmit(){if(this.loginForm.invalid){this.loginForm.markAllAsTouched();return}this.isLoading.set(!0),this.errorMessage.set("");let{username:a,password:l}=this.loginForm.value;this.authService.login(a,l).subscribe({next:e=>{this.isLoading.set(!1),e.success&&this.router.navigate(["/dashboard"])},error:e=>{this.isLoading.set(!1),e.status===401?this.errorMessage.set("Usuario o contrase\xF1a incorrectos"):this.errorMessage.set("Error al iniciar sesi\xF3n. Por favor, intente nuevamente.")}})}togglePassword(){this.showPassword.set(!this.showPassword())}onRegister(){if(this.registerForm.invalid){this.registerForm.markAllAsTouched();return}this.isRegistering.set(!0),this.registerError.set("");let{username:a,password:l,email:e}=this.registerForm.value,g=typeof e=="string"&&e.trim().length>0?e.trim():void 0;this.authService.register(a,l,g).subscribe({next:c=>{this.isRegistering.set(!1),c.success?(this.registerForm.reset(),this.router.navigate(["/dashboard"])):this.registerError.set("No se pudo completar el registro.")},error:c=>{this.isRegistering.set(!1),c.status===409?this.registerError.set("El usuario o email ya existe."):this.registerError.set("Error al registrar. Intente nuevamente.")}})}toggleRegisterPassword(){this.showRegisterPassword.set(!this.showRegisterPassword())}static \u0275fac=function(l){return new(l||n)(F(q),F(R),F(N))};static \u0275cmp=k({type:n,selectors:[["app-login"]],decls:68,vars:27,consts:[[1,"login-container"],[1,"login-card"],[1,"login-header"],[1,"logo"],["width","48","height","48","viewBox","0 0 48 48","fill","none"],["cx","24","cy","24","r","20","fill","url(#gradient)"],["d","M24 12v24M16 24h16","stroke","white","stroke-width","3","stroke-linecap","round"],["id","gradient","x1","0","y1","0","x2","48","y2","48"],["offset","0%","stop-color","#667eea"],["offset","100%","stop-color","#764ba2"],[1,"login-form",3,"ngSubmit","formGroup"],[1,"error-alert"],[1,"form-group"],["for","username"],["id","username","type","text","formControlName","username","placeholder","Ingrese su usuario"],[1,"error-text"],["for","password"],[1,"password-input"],["id","password","formControlName","password","placeholder","Ingrese su contrase\xF1a",3,"type"],["type","button","tabindex","-1",1,"toggle-password",3,"click"],["width","20","height","20","viewBox","0 0 20 20","fill","currentColor"],[1,"form-group-checkbox"],["id","remember","type","checkbox","formControlName","rememberMe"],["for","remember"],["type","submit",1,"btn-login",3,"disabled"],[1,"register-section"],[1,"section-title"],[1,"register-form",3,"ngSubmit","formGroup"],["for","register-username"],["id","register-username","type","text","formControlName","username","placeholder","Crea tu usuario"],["for","register-password"],["id","register-password","formControlName","password","placeholder","Crea tu contrase\xF1a",3,"type"],["for","register-email"],["id","register-email","type","email","formControlName","email","placeholder","correo@ejemplo.com"],["type","submit",1,"btn-register",3,"disabled"],[1,"login-footer"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"],["d","M10 12a2 2 0 100-4 2 2 0 000 4z"],["fill-rule","evenodd","d","M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z"],["fill-rule","evenodd","d","M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z"],["d","M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z"],[1,"spinner"]],template:function(l,e){if(l&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),p(),t(4,"svg",4),s(5,"circle",5)(6,"path",6),t(7,"defs")(8,"linearGradient",7),s(9,"stop",8)(10,"stop",9),i()()()(),L(),t(11,"h1"),r(12,"NutriWeb"),i(),t(13,"p"),r(14,"Sistema de Historias Cl\xEDnicas Nutricionales"),i()(),t(15,"form",10),b("ngSubmit",function(){return e.onSubmit()}),d(16,U,4,1,"div",11),t(17,"div",12)(18,"label",13),r(19,"Usuario"),i(),s(20,"input",14),d(21,H,2,0,"span",15),i(),t(22,"div",12)(23,"label",16),r(24,"Contrase\xF1a"),i(),t(25,"div",17),s(26,"input",18),t(27,"button",19),b("click",function(){return e.togglePassword()}),d(28,W,3,0,":svg:svg",20)(29,J,3,0,":svg:svg",20),i()(),d(30,K,2,0,"span",15),i(),t(31,"div",21),s(32,"input",22),t(33,"label",23),r(34,"Recordar mi sesi\xF3n"),i()(),t(35,"button",24),d(36,Q,2,0)(37,X,1,0),i()(),t(38,"div",25)(39,"div",26),r(40,"Crear cuenta"),i(),t(41,"form",27),b("ngSubmit",function(){return e.onRegister()}),d(42,Z,4,1,"div",11),t(43,"div",12)(44,"label",28),r(45,"Usuario"),i(),s(46,"input",29),d(47,$,2,0,"span",15),i(),t(48,"div",12)(49,"label",30),r(50,"Contrase\xF1a"),i(),t(51,"div",17),s(52,"input",31),t(53,"button",19),b("click",function(){return e.toggleRegisterPassword()}),d(54,ee,3,0,":svg:svg",20)(55,te,3,0,":svg:svg",20),i()(),d(56,ne,2,0,"span",15),i(),t(57,"div",12)(58,"label",32),r(59,"Email (opcional)"),i(),s(60,"input",33),d(61,ie,2,0,"span",15),i(),t(62,"button",34),d(63,oe,2,0)(64,re,1,0),i()()(),t(65,"div",35)(66,"p"),r(67,"\xA9 2024 NutriWeb. Todos los derechos reservados."),i()()()()),l&2){let g,c,C,v,w,M,P,x,S,O;o(15),f("formGroup",e.loginForm),o(),m(e.errorMessage()?16:-1),o(4),_("invalid",((g=e.loginForm.get("username"))==null?null:g.invalid)&&((g=e.loginForm.get("username"))==null?null:g.touched)),o(),m((c=e.loginForm.get("username"))!=null&&c.invalid&&((c=e.loginForm.get("username"))!=null&&c.touched)?21:-1),o(5),_("invalid",((C=e.loginForm.get("password"))==null?null:C.invalid)&&((C=e.loginForm.get("password"))==null?null:C.touched)),f("type",e.showPassword()?"text":"password"),o(2),m(e.showPassword()?28:29),o(2),m((v=e.loginForm.get("password"))!=null&&v.invalid&&((v=e.loginForm.get("password"))!=null&&v.touched)?30:-1),o(5),f("disabled",e.loginForm.invalid||e.isLoading()),o(),m(e.isLoading()?36:37),o(5),f("formGroup",e.registerForm),o(),m(e.registerError()?42:-1),o(4),_("invalid",((w=e.registerForm.get("username"))==null?null:w.invalid)&&((w=e.registerForm.get("username"))==null?null:w.touched)),o(),m((M=e.registerForm.get("username"))!=null&&M.invalid&&((M=e.registerForm.get("username"))!=null&&M.touched)?47:-1),o(5),_("invalid",((P=e.registerForm.get("password"))==null?null:P.invalid)&&((P=e.registerForm.get("password"))==null?null:P.touched)),f("type",e.showRegisterPassword()?"text":"password"),o(2),m(e.showRegisterPassword()?54:55),o(2),m((x=e.registerForm.get("password"))!=null&&x.invalid&&((x=e.registerForm.get("password"))!=null&&x.touched)?56:-1),o(4),_("invalid",((S=e.registerForm.get("email"))==null?null:S.invalid)&&((S=e.registerForm.get("email"))==null?null:S.touched)),o(),m((O=e.registerForm.get("email"))!=null&&O.invalid&&((O=e.registerForm.get("email"))!=null&&O.touched)?61:-1),o(),f("disabled",e.registerForm.invalid||e.isRegistering()),o(),m(e.isRegistering()?63:64)}},dependencies:[T,Y,D,G,z,I,A,j,V],styles:[".login-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#667eea,#764ba2);padding:1rem}.login-card[_ngcontent-%COMP%]{background:#fff;border-radius:1rem;box-shadow:0 20px 60px #0000004d;width:100%;max-width:440px;overflow:hidden;animation:_ngcontent-%COMP%_slideIn .3s ease-out}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.login-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:3rem 2rem 2rem;text-align:center}.logo[_ngcontent-%COMP%]{margin-bottom:1rem}.login-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin:0 0 .5rem}.login-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.95rem;opacity:.95;margin:0}.login-form[_ngcontent-%COMP%]{padding:2rem}.register-section[_ngcontent-%COMP%]{border-top:1px solid #e6e6e6;padding:1.5rem 2rem 2rem;background:#fafbff}.section-title[_ngcontent-%COMP%]{font-size:.85rem;font-weight:700;letter-spacing:.12em;text-transform:uppercase;color:#5a5a5a;margin-bottom:1rem}.register-form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.btn-register[_ngcontent-%COMP%]{width:100%;padding:.95rem;background:#fff;color:#667eea;border:2px solid #667eea;border-radius:.5rem;font-size:1rem;font-weight:600;cursor:pointer;transition:transform .2s,box-shadow .2s,background .2s,color .2s;display:flex;align-items:center;justify-content:center;gap:.5rem}.btn-register[_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;box-shadow:0 8px 20px #667eea40;transform:translateY(-1px)}.btn-register[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-register[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{border-color:#667eea4d;border-top-color:#667eea}.error-alert[_ngcontent-%COMP%]{background:#fee;color:#c33;padding:.875rem 1rem;border-radius:.5rem;margin-bottom:1.5rem;display:flex;align-items:center;gap:.75rem;font-size:.9rem;border:1px solid #fcc}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:600;color:#333;font-size:.95rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.875rem 1rem;border:2px solid #e0e0e0;border-radius:.5rem;font-size:1rem;transition:all .2s;box-sizing:border-box}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea1a}.form-group[_ngcontent-%COMP%]   input.invalid[_ngcontent-%COMP%]{border-color:#f44336}.password-input[_ngcontent-%COMP%]{position:relative}.password-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-right:3rem}.toggle-password[_ngcontent-%COMP%]{position:absolute;right:.75rem;top:50%;transform:translateY(-50%);background:none;border:none;color:#666;cursor:pointer;padding:.5rem;display:flex;align-items:center;justify-content:center;transition:color .2s}.toggle-password[_ngcontent-%COMP%]:hover{color:#667eea}.error-text[_ngcontent-%COMP%]{display:block;color:#f44336;font-size:.85rem;margin-top:.375rem}.form-group-checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:1.5rem}.form-group-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:1.125rem;height:1.125rem;cursor:pointer}.form-group-checkbox[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none;color:#666;font-size:.9rem}.btn-login[_ngcontent-%COMP%]{width:100%;padding:1rem;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:.5rem;font-size:1rem;font-weight:600;cursor:pointer;transition:transform .2s,box-shadow .2s;display:flex;align-items:center;justify-content:center;gap:.5rem}.btn-login[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 8px 20px #667eea66}.btn-login[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.btn-login[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.spinner[_ngcontent-%COMP%]{width:1rem;height:1rem;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.login-footer[_ngcontent-%COMP%]{padding:1.5rem 2rem;background:#f8f9fa;text-align:center;border-top:1px solid #e0e0e0}.login-footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;font-size:.85rem}@media(max-width:480px){.login-card[_ngcontent-%COMP%]{border-radius:0}.login-header[_ngcontent-%COMP%]{padding:2rem 1.5rem 1.5rem}.login-form[_ngcontent-%COMP%], .register-section[_ngcontent-%COMP%]{padding:1.5rem}.login-footer[_ngcontent-%COMP%]{padding:1rem 1.5rem}}"]})};export{B as LoginComponent};
